"use strict";(self.webpackChunkknowledge=self.webpackChunkknowledge||[]).push([[354],{5576:(a,e,s)=>{s.r(e),s.d(e,{data:()=>n});const n={key:"v-d4700b5c",path:"/middleware/embulk/digdag%E3%81%A8%E3%81%AF.html",title:"Digdagとは？",lang:"ja",frontmatter:{},excerpt:"",headers:[{level:2,title:"Digdagのインストール",slug:"digdagのインストール",children:[]},{level:2,title:"Digdagサーバーの実行",slug:"digdagサーバーの実行",children:[]},{level:2,title:"設定はdigファイルで管理する",slug:"設定はdigファイルで管理する",children:[]},{level:2,title:"digファイルの書き方",slug:"digファイルの書き方",children:[]},{level:2,title:"Digdagのインストール",slug:"digdagのインストール-1",children:[]},{level:2,title:"パスを通す",slug:"パスを通す",children:[]},{level:2,title:"ワークフローの作成",slug:"ワークフローの作成",children:[]},{level:2,title:"ワークフローの実行",slug:"ワークフローの実行",children:[]},{level:2,title:"Digdagサーバーを起動させる",slug:"digdagサーバーを起動させる",children:[]},{level:2,title:"Digdag",slug:"digdag",children:[]},{level:2,title:"参考",slug:"参考",children:[]}],filePathRelative:"middleware/embulk/digdagとは.md",git:{updatedTime:1639532968e3}}},4957:(a,e,s)=>{s.r(e),s.d(e,{default:()=>g});var n=s(6252);const i=(0,n.uE)('<h1 id="digdagとは" tabindex="-1"><a class="header-anchor" href="#digdagとは" aria-hidden="true">#</a> Digdagとは？</h1><ul><li>バッチの実行などのワークフローエンジン</li></ul><h2 id="digdagのインストール" tabindex="-1"><a class="header-anchor" href="#digdagのインストール" aria-hidden="true">#</a> Digdagのインストール</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">curl</span> -o ~/bin/digdag -L <span class="token string">&quot;https://dl.digdag.io/digdag-latest&quot;</span>\n<span class="token function">sudo</span> <span class="token function">chmod</span> +x ~/bin/digdag\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="digdagサーバーの実行" tabindex="-1"><a class="header-anchor" href="#digdagサーバーの実行" aria-hidden="true">#</a> Digdagサーバーの実行</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>digdag server -c ~/.config/digdag/config\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="設定はdigファイルで管理する" tabindex="-1"><a class="header-anchor" href="#設定はdigファイルで管理する" aria-hidden="true">#</a> 設定はdigファイルで管理する</h2><ul><li>書式はymlファイルとほぼ一緒 ※ymlファイルでない理由はmapのキーのキーの順番を維持するため(らしい)</li><li>ファイル名 = ワークフローの名前となる(hoge.dig → hoge)</li></ul><h2 id="digファイルの書き方" tabindex="-1"><a class="header-anchor" href="#digファイルの書き方" aria-hidden="true">#</a> digファイルの書き方</h2><ul><li>タスクとオペレータ、変数定義を記述する <ul><li>タスク(+XXXXX:) →１つの処理単位を書く</li><li>オペレータ(XXXX&gt;:)→実行する処理を書く</li><li>変数定義</li></ul></li><li>定義した変数は <code>${～}</code> で取得する</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sh</span> <span class="token operator">&gt;</span>: <span class="token builtin class-name">echo</span> <span class="token variable">${hoge}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><ul><li>timezone, session-uuidなどのビルドイン変数が利用できる</li><li>タスクの並列実行は_parallel: trueを指定する</li><li>バックグラウンド実行は <code>_background: true</code> を指定する</li><li>エラー通知は <code>_error:</code>メッセージでワークフロー失敗時に実行する</li></ul><h2 id="digdagのインストール-1" tabindex="-1"><a class="header-anchor" href="#digdagのインストール-1" aria-hidden="true">#</a> Digdagのインストール</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">curl</span> -o ~/bin/digdag --create-dirs -L <span class="token string">&quot;https://dl.digdag.io/digdag-latest&quot;</span>\n<span class="token function">chmod</span> +x ~/bin/digdag\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="パスを通す" tabindex="-1"><a class="header-anchor" href="#パスを通す" aria-hidden="true">#</a> パスを通す</h2><p>.zshrcに以下を追記する(記載済みの場合は不要)</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token string">&quot;<span class="token environment constant">$HOME</span>/bin:<span class="token environment constant">$PATH</span>&quot;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="ワークフローの作成" tabindex="-1"><a class="header-anchor" href="#ワークフローの作成" aria-hidden="true">#</a> ワークフローの作成</h2><ul><li>以下コマンドを実行し、workflow.digファイルを作成する</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>digdag init workflow\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>digファイルはymlファイルと同じ構造 ※拡張子がymlではなくdigなのは普通のymlと異なりmapのキーの順番が維持される必要があるため</p><h2 id="ワークフローの実行" tabindex="-1"><a class="header-anchor" href="#ワークフローの実行" aria-hidden="true">#</a> ワークフローの実行</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>digdag run workflow.dig --project workflow\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="digdagサーバーを起動させる" tabindex="-1"><a class="header-anchor" href="#digdagサーバーを起動させる" aria-hidden="true">#</a> Digdagサーバーを起動させる</h2><ul><li>オンメモリで実行する場合</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>digdag server --memory\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><ul><li>databaseにデータを保存する場合</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>digdag server --database db\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="digdag" tabindex="-1"><a class="header-anchor" href="#digdag" aria-hidden="true">#</a> Digdag</h2><p>プロジェクトをアーカイブし、サーバーにアップロードする</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>digdag push sample_workflow --project workflow\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考" aria-hidden="true">#</a> 参考</h2>',32),l={href:"https://docs.digdag.io/command_reference.html",target:"_blank",rel:"noopener noreferrer"},d=(0,n.Uk)("Digdagコマンド"),r={},g=(0,s(3744).Z)(r,[["render",function(a,e){const s=(0,n.up)("OutboundLink");return(0,n.wg)(),(0,n.iD)(n.HY,null,[i,(0,n._)("ul",null,[(0,n._)("li",null,[(0,n._)("a",l,[d,(0,n.Wm)(s)])])])],64)}]])},3744:(a,e)=>{e.Z=(a,e)=>{const s=a.__vccOpts||a;for(const[a,n]of e)s[a]=n;return s}}}]);